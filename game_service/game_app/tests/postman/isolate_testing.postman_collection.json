{
	"info": {
		"_postman_id": "5ba5dc12-8f3b-4327-a4ab-8faa5b2f7232",
		"name": "Tri-Duel Game Service",
		"description": "Complete test collection for Game Service endpoints. Need test user 'alice' and correct JWT token written into env tab.\n\n## Features:\n\n- Match creation and management\n    \n- Move submission and validation\n    \n- Card visualization (SVG)\n    \n- Authentication tests\n    \n\n## Setup:\n\n1. Set base_url to Game Service URL\n    \n2. Set auth_token with JWT from Auth Service\n    \n3. Run collection in Postman\n    \n\nVersion: 1.0.1",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "49703585",
		"_collection_link": "https://cypis-olejowy-7668800.postman.co/workspace/Cypis-1010's-Workspace~294f3157-2e01-4117-8728-bd7f2eeaf015/collection/49703585-5ba5dc12-8f3b-4327-a4ab-8faa5b2f7232?action=share&source=collection_link&creator=49703585"
	},
	"item": [
		{
			"name": "1. Health Check",
			"item": [
				{
					"name": "GET Health",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has status ok\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"ok\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"health"
							]
						},
						"description": "Health check endpoint - verifies service availability"
					},
					"response": []
				}
			],
			"description": "Basic health check to verify service is running"
		},
		{
			"name": "2. Match Management",
			"item": [
				{
					"name": "POST Create Match",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response contains match_id\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"match_id\");",
									"    pm.collectionVariables.set(\"match_id\", jsonData.match_id);",
									"});",
									"",
									"pm.test(\"Response contains hand with at least one card\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.hand).to.be.an(\"array\");",
									"    pm.expect(jsonData.hand.length).to.be.above(0);",
									"});",
									"",
									"pm.test(\"Hand contains hand_index field\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.hand && jsonData.hand.length > 0) {",
									"        pm.expect(jsonData.hand[0]).to.have.property('hand_index');",
									"        pm.expect(jsonData.hand[0].hand_index).to.eql(0);",
									"    }",
									"});",
									"",
									"pm.test(\"Match status is in_progress\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql(\"in_progress\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"player1_id\": \"alice\",\n  \"player2_id\": \"bob\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/matches",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches"
							]
						},
						"description": "Creates new match between two players. Returns match_id and initial hand."
					},
					"response": []
				},
				{
					"name": "GET Match State",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response contains match details\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"match_id\");",
									"    pm.expect(jsonData).to.have.property(\"status\");",
									"    pm.expect(jsonData).to.have.property(\"current_round\");",
									"    pm.expect(jsonData).to.have.property(\"points_p1\");",
									"    pm.expect(jsonData).to.have.property(\"points_p2\");",
									"});",
									"",
									"pm.test(\"Response contains player_hand\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"player_hand\");",
									"    pm.expect(jsonData.player_hand).to.be.an(\"array\");",
									"});",
									"",
									"pm.test(\"Response contains used cards\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"used_cards\");",
									"    pm.expect(jsonData).to.have.property(\"opponent_used_cards\");",
									"});",
									"",
									"pm.test(\"current_round is a positive integer\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.current_round).to.be.at.least(1);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/matches/{{match_id}}?player_id=alice",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches",
								"{{match_id}}"
							],
							"query": [
								{
									"key": "player_id",
									"value": "alice"
								}
							]
						},
						"description": "Retrieves current match state including player's hand, used cards, and score"
					},
					"response": []
				},
				{
					"name": "POST Submit Move - Player 1",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response indicates waiting or round result\", function () {",
									"    var jsonData = pm.response.json();",
									"    var hasStatus = jsonData.hasOwnProperty(\"status\");",
									"    var hasRound = jsonData.hasOwnProperty(\"round\");",
									"    pm.expect(hasStatus || hasRound).to.be.true;",
									"});",
									"",
									"pm.test(\"If waiting, status is correct\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.status) {",
									"        pm.expect(jsonData.status).to.eql(\"waiting_for_opponent\");",
									"    }",
									"});",
									"",
									"pm.test(\"If round resolved, has winner and reason\", function () {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.round) {",
									"        pm.expect(jsonData).to.have.property(\"winner\");",
									"        pm.expect(jsonData).to.have.property(\"reason\");",
									"        pm.expect(jsonData).to.have.property(\"points_p1\");",
									"        pm.expect(jsonData).to.have.property(\"points_p2\");",
									"        pm.expect(jsonData).to.have.property(\"match_finished\");",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"player_id\": \"alice\",\n  \"card_index\": 0\n}"
						},
						"url": {
							"raw": "{{base_url}}/matches/{{match_id}}/move",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches",
								"{{match_id}}",
								"move"
							]
						},
						"description": "Submits card move for player1. Returns waiting status or round result."
					},
					"response": []
				},
				{
					"name": "POST Submit Move - No Auth",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 401 Unauthorized\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"pm.test(\"Response contains error detail\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"detail\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"player_id\": \"alice\",\n  \"card_index\": 0\n}"
						},
						"url": {
							"raw": "{{base_url}}/matches/{{match_id}}/move",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches",
								"{{match_id}}",
								"move"
							]
						},
						"description": "Submit move without Authorization header - expect 401"
					},
					"response": []
				},
				{
					"name": "POST Submit Move - Wrong Player",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 403 Forbidden\", function () {",
									"    pm.response.to.have.status(403);",
									"});",
									"",
									"pm.test(\"Response contains error detail\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"detail\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"player_id\": \"bob\",\n  \"card_index\": 0\n}"
						},
						"url": {
							"raw": "{{base_url}}/matches/{{match_id}}/move",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches",
								"{{match_id}}",
								"move"
							]
						},
						"description": "Submit move as Bob but using Alice's token - expect 403"
					},
					"response": []
				}
			],
			"description": "Match creation, state retrieval, and move submission"
		},
		{
			"name": "3. Card Visualization (SVG)",
			"item": [
				{
					"name": "GET Deck Gallery",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is SVG\", function () {",
									"    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"image/svg+xml\");",
									"});",
									"",
									"pm.test(\"Response contains SVG content\", function () {",
									"    pm.expect(pm.response.text()).to.include(\"<svg\");",
									"    pm.expect(pm.response.text()).to.include(\"</svg>\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/cards",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"cards"
							]
						},
						"description": "Returns SVG visualization of all cards in grid layout (public endpoint)"
					},
					"response": []
				},
				{
					"name": "GET Card Detail",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is SVG\", function () {",
									"    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"image/svg+xml\");",
									"});",
									"",
									"pm.test(\"Response contains SVG content\", function () {",
									"    pm.expect(pm.response.text()).to.include(\"<svg\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/cards/1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"cards",
								"1"
							]
						},
						"description": "Returns SVG visualization of specific card with details (public)"
					},
					"response": []
				},
				{
					"name": "GET Player Hand Visualization",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response is SVG\", function () {",
									"    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"image/svg+xml\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/matches/{{match_id}}/hand?player_id=alice",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches",
								"{{match_id}}",
								"hand"
							],
							"query": [
								{
									"key": "player_id",
									"value": "alice"
								}
							]
						},
						"description": "Returns SVG visualization of player's hand (available and used cards)"
					},
					"response": []
				}
			],
			"description": "Public card visualization endpoints in SVG format"
		},
		{
			"name": "4. Error Cases",
			"item": [
				{
					"name": "POST Create Match - No Auth (401)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 401 Unauthorized\", function () {",
									"    pm.response.to.have.status(401);",
									"});",
									"",
									"pm.test(\"Response contains error detail\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"detail\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"player1_id\": \"alice\",\n  \"player2_id\": \"bob\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/matches",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches"
							]
						},
						"description": "Attempts to create match without auth - should return 401"
					},
					"response": []
				},
				{
					"name": "POST Create Match - Same Player (422)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 422 Validation Error\", function () {",
									"    pm.response.to.have.status(422);",
									"});",
									"",
									"pm.test(\"Response contains validation error\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"detail\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"player1_id\": \"alice\",\n  \"player2_id\": \"alice\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/matches",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches"
							]
						},
						"description": "Attempts to create match with same player - should return 422"
					},
					"response": []
				},
				{
					"name": "GET Card Not Found (404)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404 Not Found\", function () {",
									"    pm.response.to.have.status(404);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/cards/99999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"cards",
								"99999"
							]
						},
						"description": "Attempts to get non-existent card - should return 404"
					},
					"response": []
				}
			],
			"description": "Error handling and validation tests"
		},
		{
			"name": "5. Match Surrender",
			"item": [
				{
					"name": "POST Surrender Match",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response contains match state\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property(\"status\");",
									"    pm.expect(jsonData.status).to.equal(\"finished\");",
									"    pm.expect(jsonData).to.have.property(\"match_winner\");",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{auth_token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/matches/{{match_id}}/surrender",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"matches",
								"{{match_id}}",
								"surrender"
							]
						},
						"description": "Surrender the match as the authenticated user."
					},
					"response": []
				}
			],
			"description": "Endpoints related to match surrender functionality."
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"requests": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8003"
		},
		{
			"key": "auth_token",
			"value": "your-jwt-token-here"
		},
		{
			"key": "match_id",
			"value": ""
		}
	]
}